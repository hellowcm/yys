[General]
SyntaxVersion=2
BeginHotkey=122
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=9fc2bdfc-f2b5-4811-8eed-a7746390b430
Description=妖气封印辅助
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Main
[Relative]
SetupOCXFile=
[Comment]

[Attachment]
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


[UIPackage]
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


[Script]
// 默认延时
StringDelay = 2000
Delay 5000
appL = 0
appT = 40
appR = 1024
appB = 768

Dim startTime
startTime = Now

Dim formerpage
// 当前战斗次数
btimes = 0
// 随机数生成
Function randnumber() 
    最小 = -10*0.9 
    最大 = 10*0.91 
    // 根据实际情况设置，最小不要低过1 最大可以是3~~~10 或者3~~~~100。
    Randomize
    randnumber = Round((最大 - 最小 + 1) * Rnd + 最小) 
End Function
Dim formertxt
// 屏幕显示提示
Function showTips(txt)
    //TracePrint txt
    Main.tips.Caption = txt 
    If formertxt = txt Then
    Else
        formertxt = txt
        logtext = txt
        Call savelog
    End If
End Function

Dim logtext
Sub savelog()
    logtext = Time & "    " & logtext  & " | 已运行时间s=" & runtime
    Main.logtext.Text = Main.logtext.Text & logtext & vbCrLf
End Sub
// 随机点击屏幕
Sub randomclick()
    btop = 100
    bright = 100
    bleft = 200
    bbottom = 250
    Randomize
    x = Round((appR -bright - appL - bleft) * Rnd + appL + bleft)
    y = Round((appB - bbottom - appT  - btop) * Rnd + appT + btop)
    MoveTo x, y 
    Delay 1000
    LeftClick 1
End Sub
Sub OnScriptExit()'脚本停止事件
    btimes = 0
    Call showTips("app stop.")
End Sub

// Form events
Event Main.clearlog.Click
    Main.logtext.Text = ""
End Event


Sub findapp()
    // 句柄获取
    dim yys 
    // 找到程序位置
    Call showTips("finding app...")
    // 查找程序句柄
    yys = Plugin.Window.Find(0, "阴阳师-网易游戏")
    If yys <> 0 Then 
        //激活窗口
        Call Plugin.Window.Restore(yys)
        sRect = Plugin.Window.GetClientRect(yys)
        //下面这句用于分割字符串,将横坐标和纵坐标分成两个字符串   
        dim MyArray
        MyArray = Split(sRect, "|")   
        //下面这句将字符串转换成数值   
        appL = Clng(MyArray(0)): appT = Clng(MyArray(1))   
        appR = Clng(MyArray(2)): appB = Clng(MyArray(3))   
        Call showTips(yys & " |左" & appL & ",右 " & appR & ",上" & appT & ",下" & appB)
    Else
        Call showTips("阴阳师桌面版没有运行，请先运行游戏再启动程序")
        ExitScript 
    End If
    Delay StringDelay
End Sub

Call findapp()

// 觉醒入口
Dim jxbtn(1)
jxbtn(0) = 85 + appL
jxbtn(1) = appB - 50
// 准备按钮
Dim readybtn(1)
readybtn(0) = appR - 145
readybtn(1) = appB - 180
// pos
Dim anypos(1)
Dim closebtn(1)
Dim groupbtn(1)

// 打开组队界面
Sub openGroup()
    MoveTo jxbtn(0) + randnumber, jxbtn(1) + randnumber
    Delay StringDelay
    LeftClick 1
    // 选择材料入口
    Delay StringDelay
    MoveTo appL + 225+randnumber, 300 + appT+randnumber
    Delay StringDelay
    LeftClick 1
    Delay StringDelay

    // 找组队按钮
    MoveTo 570+appL+randnumber, 440+appT+randnumber
    Delay StringDelay
    LeftClick 1
End Sub

// 去妖气封印
Sub gotoyq()
    // "252A2D","-2|8|32383D,-6|9|25292D,0|14|202427,-5|18|383E43,4|18|2A2F33,15|18|202427,8|11|2B3135,13|8|2E3337,7|3|30363A,10|2|3F464C,12|0|282D31"
    // "212629","0|4|22262A,0|8|2F3439,-5|18|212528,11|6|24292C,9|20|353B40,15|6|282C30,23|8|2F3438"
    XY=Plugin.Color.FindMutiColor(appL,appT,appR,appB,"212629","0|4|22262A,0|8|2F3439,-5|18|212528,11|6|24292C,9|20|353B40,15|6|282C30,23|8|2F3438",0.8)
    MyArray = Split(XY, "|")
    X = CInt(MyArray(0)): Y = CInt(MyArray(1))
    If X > 0 And Y > 0 Then
        Call showTips("点击妖气封印")
        MoveTo X + randnumber, Y + randnumber
        Delay StringDelay
        LeftClick 1
    Else
        // 翻页
        MoveTo 220+appL+randnumber, 260+appT+randnumber
        Delay StringDelay
        MouseWheel -1
        Delay 100
        MouseWheel -1
        Delay 100
        MouseWheel -1
        Delay 100
    End If
End Sub

// 妖气APP
Sub yq_app()
    Rem yaoqi_start
    // 判断运行时间
    runtime = DateDiff("s", startTime, Now)

    // 战斗次数
    maxtimes = CInt(Main.maxtimes.Text)
    If btimes > maxtimes Then
        Call showTips("达到最大战斗次数，脚本停止运行")
        ExitScript
    End If

    // 检测当前页
    nowpage = -1
    Do
        // 首页
        XY=Plugin.Color.FindMutiColor(appL,appT,appR,appB,"312FA3","9|5|C3C6D5,21|12|B6B8C7,8|23|4D50E0,-12|44|C2C5D4",1)
        MyArray = Split(XY, "|")
        X = CInt(MyArray(0)): Y = CInt(MyArray(1))
        If X > 0 And Y > 0 Then
            nowpage = 0
            groupbtn(0) = X : groupbtn(1) = Y
            Goto checkend
        End If
        // 首页组队
        XY=Plugin.Color.FindMutiColor(appL,appT,appR,appB,"E0F3F8","-4|7|DEF0F6,1|7|DFF2F7,-3|12|DDF0F5,2|12|E0F3F8,2|17|DBEDF3,-3|19|E0F3F8,8|9|E0F3F8,17|9|E0F3F8,17|20|E0F3F8,8|20|E0F3F8",1)
        MyArray = Split(XY, "|")
        X = CInt(MyArray(0)): Y = CInt(MyArray(1))
        If X > 0 And Y > 0 Then
            nowpage = 0
            groupbtn(0) = X : groupbtn(1) = Y
            Goto checkend
        End If

        // 大地图界面
        XY=Plugin.Color.FindMutiColor(appL,appT,appR,appB,"178ACE","-3|12|8B3189,15|1|8E368D,22|2|A03CA0,32|2|1680C5,33|9|AAD3E1,39|25|B1D8E4,48|36|2769A1,49|40|9BBECD",1)
        MyArray = Split(XY, "|")
        X = CInt(MyArray(0)): Y = CInt(MyArray(1))
        If X > 0 And Y > 0 Then
            nowpage = 2
            Goto checkend
        End If

        XY=Plugin.Color.FindMutiColor(appL,appT,appR,appB,"E0F3F8","-2|9|DDF0F5,3|7|DBEEF3,1|14|E0F3F8,14|-2|DAECF1,11|-1|C5D7DD,8|0|A0B0B7,11|4|DBEDF2,7|7|E0F3F8,10|9|DFF2F7,16|15|E0F3F8",1)
        MyArray = Split(XY, "|")
        X = CInt(MyArray(0)): Y = CInt(MyArray(1))
        If X > 0 And Y > 0 Then
            //Call showTips("在妖气封印界面")
            nowpage = 10
            Goto checkend
        End If

        XY=Plugin.Color.FindMutiColor(appL,appT,appR,appB,"D6E8EE","-4|5|DDF0F5,-6|9|DFF2F7,2|6|DFF2F7,-2|11|DFF3F8,-5|16|E0F3F8,1|14|DCEFF4,-5|22|E0F3F8,7|5|DEF1F6,7|11|DCEFF4,7|21|E0F3F8,15|3|E0F3F8,15|11|E0F3F8,15|22|E0F3F8,18|22|E0F3F8",1)
        MyArray = Split(XY, "|")
        X = CInt(MyArray(0)): Y = CInt(MyArray(1))
        If X > 0 And Y > 0 Then
            //Call showTips("在组队界面")
            nowpage = 5
            Goto checkend
        End If

        XY=Plugin.Color.FindMutiColor(appL,appT,appR,appB,"D0F2FF","-5|10|D0F2FF,5|6|D0F2FF,0|12|D0F2FF,-4|19|D0F2FF,-4|28|D0F2FF,11|4|D0F2FF,11|18|D0F2FF,11|28|D0F2FF,22|28|D0F2FF,22|3|D0F2FF",1)
        MyArray = Split(XY, "|")
        X = CInt(MyArray(0)): Y = CInt(MyArray(1))
        If X > 0 And Y > 0 Then
            //进入战斗
            nowpage = 20
        End If

        FindColor appL,appT,appR,appB,"A1BBD4",intX,intY
        If intX> 0 And intY> 0 Then
            // 战斗准备
            nowpage = 21
            Goto checkend
        End If

        // battle end 
        XY=Plugin.Color.FindMutiColor(appL,appT,appR,appB,"31D3E1","5|9|081333,9|13|2CAFE0,6|19|3BB6E3,11|19|27B4E4",1)
        MyArray = Split(XY, "|")
        X = CInt(MyArray(0)): Y = CInt(MyArray(1))
        If X > 0 And Y > 0 Then
            //战斗结束
            Call showTips("战斗奖励结算")
            nowpage = 30
            anypos(0) = X : anypos(1) = Y
            Goto checkend
        End If

        // fail
        XY=Plugin.Color.FindMutiColor(appL,appT,appR,appB,"50424A","6|22|51424A,-11|42|65525B,20|42|5A4950,42|42|69555F,29|80|6D5861,-3|80|836A74",1)
        MyArray = Split(XY, "|")
        X = CInt(MyArray(0)): Y = CInt(MyArray(1))
        If X > 0 And Y > 0 Then
            //战斗结束
            Call showTips("战斗失败")
            nowpage = 30
            anypos(0) = X : anypos(1) = Y
            Goto checkend
        End If

        // other has close icon
        FindPic appL,appT,appR,appB, "Attachment:\close.bmp", 0.5, intX, intY
        If intX > 0 and intY > 0 Then 
            Call showTips("has close btn_" & intX & "," & intY) 
            closebtn(0) = intX + 10
            closebtn(1) = intY + 10
            //nowpage = 3
        End If

        Rem checkend
        Exit Do
    Loop

    Call showTips("妖气封印 | nowpage=" & nowpage & " | btimes=" & btimes)

    Select Case nowpage
        Case 0
            MoveTo groupbtn(0)+randnumber, groupbtn(1)+randnumber
            Delay StringDelay
            LeftClick 1
        Case 2
            Call openGroup()
        Case 5
            Call gotoyq()
        Case 3
            MoveTo closebtn(0)+randnumber, closebtn(1)+randnumber
            Delay StringDelay
            LeftClick 1
        Case 10
            // 检测有的妖气封印
            // 点击刷新
            MoveTo appL+430+randnumber, appB-70+randnumber
            Delay 500
            LeftClick 1

            // check yaoqi
            For 3
                // 日和坊
                XY=Plugin.Color.FindMutiColor(appL,appT,appR,appB,"2D3236","0|4|262B2E,-3|11|222629,9|-1|25292D,8|7|272B2E,10|15|202427",0.8)
                MyArray = Split(XY, "|")
                X = CInt(MyArray(0)): Y = CInt(MyArray(1))
                If X > 0 And Y > 0 Then
                    Call showTips("日和坊: " & X & "," & Y)
                    MoveTo X + 450 + randnumber, Y + 20+randnumber
                    Delay 300
                    LeftClick 1
                    Exit For
                End If
                Delay 500
            Next
        Case 21
            MoveTo readybtn(0)+randnumber, readybtn(1)+randnumber
            Delay 1000
            LeftClick 1
        Case 30
            MoveTo anypos(0) + randnumber, anypos(1)+randnumber
            Delay StringDelay
            LeftClick 1
            If formerpage <> 30 Then
                btimes = btimes + 1
            End If
    End Select

    Delay 1000

    If formerpage <> nowpage Then
        formerpage = nowpage
    End If

    Goto yaoqi_start
End Sub


Sub dj_app()
    Rem dj_start
    // 判断运行时间
    runtime = DateDiff("s", startTime, Now)
    
    Call showTips("斗技线程...")
    Delay StringDelay
    Goto dj_start
End Sub
// 妖气封印线程
Global yqthread
// 斗技线程
Global djthread

Event Main.yqstart.Click
    If djthread <> 0 Then
        StopThread djthread
    End If
    If yqthread <> 0 Then
        StopThread yqthread
    End If
    yqthread = BeginThread(yq_app)
End Event

Event Main.djstart.Click
    If djthread <> 0 Then
        StopThread djthread
    End If
    If yqthread <> 0 Then
        StopThread yqthread
    End If
    djthread = BeginThread(dj_app)
End Event